

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create and evaluate handcrafted classification rules in decision-rules &mdash; decision_rules 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Evaluate classification rules in decision-rules" href="rules_regression.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            decision_rules
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../key_concepts.html">Introduction</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Define rules manually</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules_regression.html">Evaluate regression rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_with_rulekit.html">Generate rules using RuleKit algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="cn2.html">Generate rules using CN2 algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../illustrative_example.html">Illustrative examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../decision_rules.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">decision_rules</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Create and evaluate handcrafted classification rules in decision-rules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/manual_rules_classification.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Create-and-evaluate-handcrafted-classification-rules-in-decision-rules">
<h1>Create and evaluate handcrafted classification rules in decision-rules<a class="headerlink" href="#Create-and-evaluate-handcrafted-classification-rules-in-decision-rules" title="Link to this heading"></a></h1>
<p>In this tutorial we will create manually decision rules for and evaluate them.</p>
<p>We begin by loading the iris dataset into a DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">IRIS_PATH</span> <span class="o">=</span> <span class="s1">&#39;resources/iris.csv&#39;</span>
<span class="n">iris_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">IRIS_PATH</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">iris_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns: &#39;</span><span class="p">,</span> <span class="n">iris_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Class names:&#39;</span><span class="p">,</span> <span class="n">iris_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepallength</th>
      <th>sepalwidth</th>
      <th>petallength</th>
      <th>petalwidth</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Columns:  [&#39;sepallength&#39; &#39;sepalwidth&#39; &#39;petallength&#39; &#39;petalwidth&#39; &#39;class&#39;]
Class names: [&#39;Iris-setosa&#39; &#39;Iris-versicolor&#39; &#39;Iris-virginica&#39;]
</pre></div></div>
</div>
<p>The task is to predict the class of an example (Iris-setosa, Iris-versicolor or Iris-virginica) using the values in the other columns (‘sepallength’, ‘sepalwidth’, ‘petallength’, ‘petalwidth’). We will store the predictors in the X variable and the target in y.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">iris_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Someone suggested the following simple rules:</p>
<ol class="arabic simple">
<li><p>If <span class="math notranslate nohighlight">\(petallength &lt; 2.5\)</span>, then it’s Iris-setosa.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(petallength \geq 2.5\)</span> and <span class="math notranslate nohighlight">\(petalwidth &lt; 1.65\)</span>, then it’s Iris-versicolor.</p></li>
<li><p>Otherwise, it’s Iris-virginica</p></li>
</ol>
<p>Let’s implement them. We will start from the first one.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decision_rules.classification.rule</span> <span class="kn">import</span> <span class="n">ClassificationConclusion</span>
<span class="kn">from</span> <span class="nn">decision_rules.classification.rule</span> <span class="kn">import</span> <span class="n">ClassificationRule</span>
<span class="kn">from</span> <span class="nn">decision_rules.conditions</span> <span class="kn">import</span> <span class="n">ElementaryCondition</span><span class="p">,</span> <span class="n">CompoundCondition</span>

<span class="n">rule_1</span> <span class="o">=</span> <span class="n">ClassificationRule</span><span class="p">(</span>
    <span class="n">premise</span><span class="o">=</span><span class="n">CompoundCondition</span><span class="p">(</span>
        <span class="n">subconditions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">ElementaryCondition</span><span class="p">(</span>
                <span class="n">column_index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;petallength&#39;</span><span class="p">),</span>
                <span class="n">right</span> <span class="o">=</span> <span class="mf">2.5</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">conclusion</span><span class="o">=</span><span class="n">ClassificationConclusion</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">,</span>
        <span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">column_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">ClassificationRule</span></code> class to create the rule. Every rule has two parts: premise (e.g. <span class="math notranslate nohighlight">\(petallength &lt; 2.5\)</span>) and conclusion (e.g. Iris-setosa).</p>
<p>You can create a premise using the conditions from <code class="docutils literal notranslate"><span class="pre">decision_rules.conditions</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NominalCondition</span></code>: checks if a value of the attribute is equal to a value, e.g. <span class="math notranslate nohighlight">\(x = 1\)</span>. Useful for nominal attributes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ElementaryCondition</span></code>: checks if a value is inside an interval, e.g. <span class="math notranslate nohighlight">\(x \in [2.3, 3.1)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CompoundCondition</span></code>: a conjunction or alternative of <code class="docutils literal notranslate"><span class="pre">ElementaryCondition</span></code>s, e.g. <span class="math notranslate nohighlight">\(x \in [2.3, 3.1)\)</span> and <span class="math notranslate nohighlight">\(y \in (8, +\infty)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AttributesCondition</span></code>: checks if a relationship between two attributes is met, e.g. <span class="math notranslate nohighlight">\(x &lt; y\)</span>.</p></li>
</ul>
<p>In case of this rule, the premise <span class="math notranslate nohighlight">\(petallength &lt; 2.5\)</span> can be written as <span class="math notranslate nohighlight">\(petallength \in [-\infty, 2.5)\)</span>, so we can use the <code class="docutils literal notranslate"><span class="pre">ElementaryCondition</span></code>. The <code class="docutils literal notranslate"><span class="pre">column_index</span></code> argument is the index of the column with the relevant attribute (petallength). The arguments <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code> are the boundaries of the interval, their default values are minus and plus infinity respectively. The interval is open by default, we can change that by setting the <code class="docutils literal notranslate"><span class="pre">left_closed</span></code> or <code class="docutils literal notranslate"><span class="pre">right_colsed</span></code>
attribute to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Currently, the premise needs to be a <code class="docutils literal notranslate"><span class="pre">CompoundCondition</span></code>, so we put that <code class="docutils literal notranslate"><span class="pre">ElementaryCondition</span></code> as a subcondition inside a <code class="docutils literal notranslate"><span class="pre">CompoundCondition</span></code>. <code class="docutils literal notranslate"><span class="pre">CompoundCondition</span></code> has one required argument named <code class="docutils literal notranslate"><span class="pre">subconditions</span></code> which must be a list of <code class="docutils literal notranslate"><span class="pre">ElementaryCondition</span></code> objects.</p>
<p>The conclusion is a <code class="docutils literal notranslate"><span class="pre">ClassificationConclusion</span></code> object. It accepts two arguments: the predicted value (Iris-setosa) and the column name (class).</p>
<p>Now, let’s create the rule 2. The premise is a conjunction (has two parts joined by “and”), so we will use again <code class="docutils literal notranslate"><span class="pre">CompoundCondition</span></code>. This time the <code class="docutils literal notranslate"><span class="pre">subconditions</span></code> list will have two elementary conditions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rule_2</span> <span class="o">=</span> <span class="n">ClassificationRule</span><span class="p">(</span>
    <span class="n">premise</span><span class="o">=</span><span class="n">CompoundCondition</span><span class="p">(</span>
        <span class="n">subconditions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">ElementaryCondition</span><span class="p">(</span>
                <span class="n">column_index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;petallength&#39;</span><span class="p">),</span>
                <span class="n">left</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span>
                <span class="n">left_closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">ElementaryCondition</span><span class="p">(</span>
                <span class="n">column_index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;petalwidth&#39;</span><span class="p">),</span>
                <span class="n">right</span> <span class="o">=</span> <span class="mf">1.65</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">conclusion</span><span class="o">=</span><span class="n">ClassificationConclusion</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">,</span>
        <span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">column_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now that we have all the rules, we can create the rule set. To to this, we use the <code class="docutils literal notranslate"><span class="pre">ClassificationRuleSet</span></code> class. It has one mandatory argument <code class="docutils literal notranslate"><span class="pre">rules</span></code> which is a list of <code class="docutils literal notranslate"><span class="pre">ClassificationRule</span></code> objects</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decision_rules.classification.ruleset</span> <span class="kn">import</span> <span class="n">ClassificationRuleSet</span>

<span class="n">ruleset</span> <span class="o">=</span> <span class="n">ClassificationRuleSet</span><span class="p">(</span><span class="n">rules</span><span class="o">=</span><span class="p">[</span><span class="n">rule_1</span><span class="p">,</span> <span class="n">rule_2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We still need to add the 3rd rule (otherwise, it’s Iris-virginica). We implement such a rule using the <code class="docutils literal notranslate"><span class="pre">default_conclusion</span></code> property of a ruleset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ruleset</span><span class="o">.</span><span class="n">default_conclusion</span> <span class="o">=</span> <span class="n">ClassificationConclusion</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Iris-virginica&#39;</span><span class="p">,</span>
    <span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now the rule set is almost ready. After defining the rules, you should call the <code class="docutils literal notranslate"><span class="pre">update</span></code> function. It accepts 3 arguments:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> of predictors (X)</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">Series</span></code> of target values (y)</p></li>
<li><p>a measure of rule quality</p></li>
</ul>
<p>This function calculates also the coverage matrix, which shows which rules cover each row.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decision_rules.measures</span> <span class="kn">import</span> <span class="n">accuracy</span>
<span class="n">coverage_matrix</span> <span class="o">=</span> <span class="n">ruleset</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">coverage_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [ True, False],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False, False],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False, False],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False,  True],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False,  True],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False,  True],
       [False, False],
       [False, False],
       [False, False],
       [False,  True],
       [False,  True],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False],
       [False, False]])
</pre></div></div>
</div>
<p>The ruleset is ready now. Let’s see what it will predict for our data stored in X variable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The predictions for each row in X will be stored in the y_pred array.</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">ruleset</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># The compare_df will show us the true class and the prediction for each example.</span>
<span class="n">compare_df</span> <span class="o">=</span> <span class="n">iris_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">compare_df</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">compare_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepallength</th>
      <th>sepalwidth</th>
      <th>petallength</th>
      <th>petalwidth</th>
      <th>class</th>
      <th>predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.4</td>
      <td>3.9</td>
      <td>1.7</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4.6</td>
      <td>3.4</td>
      <td>1.4</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5.0</td>
      <td>3.4</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.4</td>
      <td>2.9</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.9</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>10</th>
      <td>5.4</td>
      <td>3.7</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>11</th>
      <td>4.8</td>
      <td>3.4</td>
      <td>1.6</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4.8</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4.3</td>
      <td>3.0</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5.8</td>
      <td>4.0</td>
      <td>1.2</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>15</th>
      <td>5.7</td>
      <td>4.4</td>
      <td>1.5</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>16</th>
      <td>5.4</td>
      <td>3.9</td>
      <td>1.3</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5.7</td>
      <td>3.8</td>
      <td>1.7</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>19</th>
      <td>5.1</td>
      <td>3.8</td>
      <td>1.5</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5.4</td>
      <td>3.4</td>
      <td>1.7</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>21</th>
      <td>5.1</td>
      <td>3.7</td>
      <td>1.5</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.6</td>
      <td>3.6</td>
      <td>1.0</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>23</th>
      <td>5.1</td>
      <td>3.3</td>
      <td>1.7</td>
      <td>0.5</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>24</th>
      <td>4.8</td>
      <td>3.4</td>
      <td>1.9</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>25</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.6</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>26</th>
      <td>5.0</td>
      <td>3.4</td>
      <td>1.6</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>27</th>
      <td>5.2</td>
      <td>3.5</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>28</th>
      <td>5.2</td>
      <td>3.4</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>29</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.6</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>30</th>
      <td>4.8</td>
      <td>3.1</td>
      <td>1.6</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>31</th>
      <td>5.4</td>
      <td>3.4</td>
      <td>1.5</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>32</th>
      <td>5.2</td>
      <td>4.1</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>33</th>
      <td>5.5</td>
      <td>4.2</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>34</th>
      <td>4.9</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>35</th>
      <td>5.0</td>
      <td>3.2</td>
      <td>1.2</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>36</th>
      <td>5.5</td>
      <td>3.5</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>37</th>
      <td>4.9</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>38</th>
      <td>4.4</td>
      <td>3.0</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>39</th>
      <td>5.1</td>
      <td>3.4</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>40</th>
      <td>5.0</td>
      <td>3.5</td>
      <td>1.3</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>41</th>
      <td>4.5</td>
      <td>2.3</td>
      <td>1.3</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>42</th>
      <td>4.4</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>43</th>
      <td>5.0</td>
      <td>3.5</td>
      <td>1.6</td>
      <td>0.6</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>44</th>
      <td>5.1</td>
      <td>3.8</td>
      <td>1.9</td>
      <td>0.4</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>45</th>
      <td>4.8</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.3</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>46</th>
      <td>5.1</td>
      <td>3.8</td>
      <td>1.6</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>47</th>
      <td>4.6</td>
      <td>3.2</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>48</th>
      <td>5.3</td>
      <td>3.7</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>49</th>
      <td>5.0</td>
      <td>3.3</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Iris-setosa</td>
      <td>Iris-setosa</td>
    </tr>
    <tr>
      <th>50</th>
      <td>7.0</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>51</th>
      <td>6.4</td>
      <td>3.2</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>52</th>
      <td>6.9</td>
      <td>3.1</td>
      <td>4.9</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>53</th>
      <td>5.5</td>
      <td>2.3</td>
      <td>4.0</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>54</th>
      <td>6.5</td>
      <td>2.8</td>
      <td>4.6</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>55</th>
      <td>5.7</td>
      <td>2.8</td>
      <td>4.5</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>56</th>
      <td>6.3</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>1.6</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>57</th>
      <td>4.9</td>
      <td>2.4</td>
      <td>3.3</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>58</th>
      <td>6.6</td>
      <td>2.9</td>
      <td>4.6</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>59</th>
      <td>5.2</td>
      <td>2.7</td>
      <td>3.9</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>60</th>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.5</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>61</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>4.2</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>62</th>
      <td>6.0</td>
      <td>2.2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>63</th>
      <td>6.1</td>
      <td>2.9</td>
      <td>4.7</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>64</th>
      <td>5.6</td>
      <td>2.9</td>
      <td>3.6</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>65</th>
      <td>6.7</td>
      <td>3.1</td>
      <td>4.4</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>66</th>
      <td>5.6</td>
      <td>3.0</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>67</th>
      <td>5.8</td>
      <td>2.7</td>
      <td>4.1</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>68</th>
      <td>6.2</td>
      <td>2.2</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>69</th>
      <td>5.6</td>
      <td>2.5</td>
      <td>3.9</td>
      <td>1.1</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>70</th>
      <td>5.9</td>
      <td>3.2</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>Iris-versicolor</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>71</th>
      <td>6.1</td>
      <td>2.8</td>
      <td>4.0</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>72</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>4.9</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>73</th>
      <td>6.1</td>
      <td>2.8</td>
      <td>4.7</td>
      <td>1.2</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>74</th>
      <td>6.4</td>
      <td>2.9</td>
      <td>4.3</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>75</th>
      <td>6.6</td>
      <td>3.0</td>
      <td>4.4</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>76</th>
      <td>6.8</td>
      <td>2.8</td>
      <td>4.8</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>77</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.7</td>
      <td>Iris-versicolor</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>78</th>
      <td>6.0</td>
      <td>2.9</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>79</th>
      <td>5.7</td>
      <td>2.6</td>
      <td>3.5</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>80</th>
      <td>5.5</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>1.1</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>81</th>
      <td>5.5</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>82</th>
      <td>5.8</td>
      <td>2.7</td>
      <td>3.9</td>
      <td>1.2</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>83</th>
      <td>6.0</td>
      <td>2.7</td>
      <td>5.1</td>
      <td>1.6</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>84</th>
      <td>5.4</td>
      <td>3.0</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>85</th>
      <td>6.0</td>
      <td>3.4</td>
      <td>4.5</td>
      <td>1.6</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>86</th>
      <td>6.7</td>
      <td>3.1</td>
      <td>4.7</td>
      <td>1.5</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>87</th>
      <td>6.3</td>
      <td>2.3</td>
      <td>4.4</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>88</th>
      <td>5.6</td>
      <td>3.0</td>
      <td>4.1</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>89</th>
      <td>5.5</td>
      <td>2.5</td>
      <td>4.0</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>90</th>
      <td>5.5</td>
      <td>2.6</td>
      <td>4.4</td>
      <td>1.2</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>91</th>
      <td>6.1</td>
      <td>3.0</td>
      <td>4.6</td>
      <td>1.4</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>92</th>
      <td>5.8</td>
      <td>2.6</td>
      <td>4.0</td>
      <td>1.2</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>93</th>
      <td>5.0</td>
      <td>2.3</td>
      <td>3.3</td>
      <td>1.0</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>94</th>
      <td>5.6</td>
      <td>2.7</td>
      <td>4.2</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>95</th>
      <td>5.7</td>
      <td>3.0</td>
      <td>4.2</td>
      <td>1.2</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>96</th>
      <td>5.7</td>
      <td>2.9</td>
      <td>4.2</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>97</th>
      <td>6.2</td>
      <td>2.9</td>
      <td>4.3</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>98</th>
      <td>5.1</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>1.1</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>99</th>
      <td>5.7</td>
      <td>2.8</td>
      <td>4.1</td>
      <td>1.3</td>
      <td>Iris-versicolor</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>100</th>
      <td>6.3</td>
      <td>3.3</td>
      <td>6.0</td>
      <td>2.5</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>101</th>
      <td>5.8</td>
      <td>2.7</td>
      <td>5.1</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>102</th>
      <td>7.1</td>
      <td>3.0</td>
      <td>5.9</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>103</th>
      <td>6.3</td>
      <td>2.9</td>
      <td>5.6</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>104</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.8</td>
      <td>2.2</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>105</th>
      <td>7.6</td>
      <td>3.0</td>
      <td>6.6</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>106</th>
      <td>4.9</td>
      <td>2.5</td>
      <td>4.5</td>
      <td>1.7</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>107</th>
      <td>7.3</td>
      <td>2.9</td>
      <td>6.3</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>108</th>
      <td>6.7</td>
      <td>2.5</td>
      <td>5.8</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>109</th>
      <td>7.2</td>
      <td>3.6</td>
      <td>6.1</td>
      <td>2.5</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>110</th>
      <td>6.5</td>
      <td>3.2</td>
      <td>5.1</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>111</th>
      <td>6.4</td>
      <td>2.7</td>
      <td>5.3</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>112</th>
      <td>6.8</td>
      <td>3.0</td>
      <td>5.5</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>113</th>
      <td>5.7</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>114</th>
      <td>5.8</td>
      <td>2.8</td>
      <td>5.1</td>
      <td>2.4</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>115</th>
      <td>6.4</td>
      <td>3.2</td>
      <td>5.3</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>116</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.5</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>117</th>
      <td>7.7</td>
      <td>3.8</td>
      <td>6.7</td>
      <td>2.2</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>118</th>
      <td>7.7</td>
      <td>2.6</td>
      <td>6.9</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>119</th>
      <td>6.0</td>
      <td>2.2</td>
      <td>5.0</td>
      <td>1.5</td>
      <td>Iris-virginica</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>120</th>
      <td>6.9</td>
      <td>3.2</td>
      <td>5.7</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>121</th>
      <td>5.6</td>
      <td>2.8</td>
      <td>4.9</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>122</th>
      <td>7.7</td>
      <td>2.8</td>
      <td>6.7</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>123</th>
      <td>6.3</td>
      <td>2.7</td>
      <td>4.9</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>124</th>
      <td>6.7</td>
      <td>3.3</td>
      <td>5.7</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>125</th>
      <td>7.2</td>
      <td>3.2</td>
      <td>6.0</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>126</th>
      <td>6.2</td>
      <td>2.8</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>127</th>
      <td>6.1</td>
      <td>3.0</td>
      <td>4.9</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>128</th>
      <td>6.4</td>
      <td>2.8</td>
      <td>5.6</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>129</th>
      <td>7.2</td>
      <td>3.0</td>
      <td>5.8</td>
      <td>1.6</td>
      <td>Iris-virginica</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>130</th>
      <td>7.4</td>
      <td>2.8</td>
      <td>6.1</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>131</th>
      <td>7.9</td>
      <td>3.8</td>
      <td>6.4</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>132</th>
      <td>6.4</td>
      <td>2.8</td>
      <td>5.6</td>
      <td>2.2</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>133</th>
      <td>6.3</td>
      <td>2.8</td>
      <td>5.1</td>
      <td>1.5</td>
      <td>Iris-virginica</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>134</th>
      <td>6.1</td>
      <td>2.6</td>
      <td>5.6</td>
      <td>1.4</td>
      <td>Iris-virginica</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>135</th>
      <td>7.7</td>
      <td>3.0</td>
      <td>6.1</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>136</th>
      <td>6.3</td>
      <td>3.4</td>
      <td>5.6</td>
      <td>2.4</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>137</th>
      <td>6.4</td>
      <td>3.1</td>
      <td>5.5</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>138</th>
      <td>6.0</td>
      <td>3.0</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>139</th>
      <td>6.9</td>
      <td>3.1</td>
      <td>5.4</td>
      <td>2.1</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>140</th>
      <td>6.7</td>
      <td>3.1</td>
      <td>5.6</td>
      <td>2.4</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>141</th>
      <td>6.9</td>
      <td>3.1</td>
      <td>5.1</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>142</th>
      <td>5.8</td>
      <td>2.7</td>
      <td>5.1</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>143</th>
      <td>6.8</td>
      <td>3.2</td>
      <td>5.9</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>144</th>
      <td>6.7</td>
      <td>3.3</td>
      <td>5.7</td>
      <td>2.5</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
      <td>Iris-virginica</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We will check now how well our rules perform on the data using various metrics. The <code class="docutils literal notranslate"><span class="pre">calculate_for_classification</span></code> function computes the typical classification metrics, such as accuracy, f1 or Cohen kappa.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decision_rules.classification.prediction_indicators</span> <span class="kn">import</span> <span class="n">calculate_for_classification</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_for_classification</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;type_of_problem&#39;: &#39;classification&#39;,
 &#39;general&#39;: {&#39;Balanced_accuracy&#39;: 0.96,
  &#39;Accuracy&#39;: 0.96,
  &#39;Cohen_kappa&#39;: 0.94,
  &#39;F1_micro&#39;: 0.96,
  &#39;F1_macro&#39;: 0.9599839935974389,
  &#39;F1_weighted&#39;: 0.9599839935974391,
  &#39;G_mean_micro&#39;: 0.9699484522385713,
  &#39;G_mean_macro&#39;: 0.9699484522385713,
  &#39;G_mean_weighted&#39;: 0.9699484522385713,
  &#39;Recall_micro&#39;: 0.96,
  &#39;Recall_macro&#39;: 0.96,
  &#39;Recall_weighted&#39;: 0.96,
  &#39;Specificity&#39;: 1.0,
  &#39;Confusion_matrix&#39;: {&#39;classes&#39;: [&#39;Iris-setosa&#39;,
    &#39;Iris-versicolor&#39;,
    &#39;Iris-virginica&#39;],
   &#39;Iris-setosa&#39;: [50, 0, 0],
   &#39;Iris-versicolor&#39;: [0, 48, 2],
   &#39;Iris-virginica&#39;: [0, 4, 46]}},
 &#39;for_classes&#39;: {&#39;Iris-setosa&#39;: {&#39;TP&#39;: 50,
   &#39;FP&#39;: 0,
   &#39;TN&#39;: 100,
   &#39;FN&#39;: 0,
   &#39;Recall&#39;: 1.0,
   &#39;Specificity&#39;: 1.0,
   &#39;F1_score&#39;: 1.0,
   &#39;G_mean&#39;: 1.0,
   &#39;MCC&#39;: 1.0,
   &#39;PPV&#39;: 1.0,
   &#39;NPV&#39;: 1.0,
   &#39;LR_plus&#39;: 0,
   &#39;LR_minus&#39;: 0.0,
   &#39;Odd_ratio&#39;: 0,
   &#39;Relative_risk&#39;: 0,
   &#39;Confusion_matrix&#39;: {&#39;classes&#39;: [&#39;Iris-setosa&#39;, &#39;other&#39;],
    &#39;Iris-setosa&#39;: [50, 0],
    &#39;other&#39;: [0, 100]}},
  &#39;Iris-versicolor&#39;: {&#39;TP&#39;: 48,
   &#39;FP&#39;: 4,
   &#39;TN&#39;: 96,
   &#39;FN&#39;: 2,
   &#39;Recall&#39;: 0.96,
   &#39;Specificity&#39;: 0.96,
   &#39;F1_score&#39;: 0.9411764705882353,
   &#39;G_mean&#39;: 0.96,
   &#39;MCC&#39;: 0.9112931795128765,
   &#39;PPV&#39;: 0.9230769230769231,
   &#39;NPV&#39;: 0.9795918367346939,
   &#39;LR_plus&#39;: 23.99999999999998,
   &#39;LR_minus&#39;: 0.041666666666666706,
   &#39;Odd_ratio&#39;: 576.0,
   &#39;Relative_risk&#39;: 45.23076923076923,
   &#39;Confusion_matrix&#39;: {&#39;classes&#39;: [&#39;Iris-versicolor&#39;, &#39;other&#39;],
    &#39;Iris-versicolor&#39;: [48, 2],
    &#39;other&#39;: [4, 96]}},
  &#39;Iris-virginica&#39;: {&#39;TP&#39;: 46,
   &#39;FP&#39;: 2,
   &#39;TN&#39;: 98,
   &#39;FN&#39;: 4,
   &#39;Recall&#39;: 0.92,
   &#39;Specificity&#39;: 0.98,
   &#39;F1_score&#39;: 0.9387755102040817,
   &#39;G_mean&#39;: 0.9495261976375375,
   &#39;MCC&#39;: 0.9095085938862487,
   &#39;PPV&#39;: 0.9583333333333334,
   &#39;NPV&#39;: 0.9607843137254902,
   &#39;LR_plus&#39;: 45.999999999999964,
   &#39;LR_minus&#39;: 0.08163265306122446,
   &#39;Odd_ratio&#39;: 563.5,
   &#39;Relative_risk&#39;: 24.4375,
   &#39;Confusion_matrix&#39;: {&#39;classes&#39;: [&#39;Iris-virginica&#39;, &#39;other&#39;],
    &#39;Iris-virginica&#39;: [46, 4],
    &#39;other&#39;: [2, 98]}}}}
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">calculate_rules_metrics</span></code> function of a ruleset object computes metrics describing each of the rules in the rule set. The full description of the metrics can be found in the <a class="reference external" href="https://github.com/ruleminer/ruleminer/wiki/10-Description-of-the-results-obtained">documentation of ruleminer</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">ruleset</span><span class="o">.</span><span class="n">calculate_rules_metrics</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rule_id</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rule&#39;</span><span class="p">,</span> <span class="n">rule_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rule fd0d78eb-aea8-4ab0-9704-6999d87573c2
{&#39;p&#39;: 50, &#39;n&#39;: 0, &#39;P&#39;: 50, &#39;N&#39;: 100, &#39;p_unique&#39;: 50, &#39;n_unique&#39;: 50, &#39;support&#39;: 50, &#39;conditions_count&#39;: 1, &#39;precision&#39;: 1.0, &#39;coverage&#39;: 1.0, &#39;C2&#39;: 1.0, &#39;RSS&#39;: 1.0, &#39;correlation&#39;: 1.0, &#39;lift&#39;: 3.0, &#39;p_value&#39;: 4.968040370318492e-41, &#39;TP&#39;: 50, &#39;FP&#39;: 0, &#39;TN&#39;: 100, &#39;FN&#39;: 0, &#39;sensitivity&#39;: 1.0, &#39;specificity&#39;: 1.0, &#39;negative_predictive_value&#39;: 1.0, &#39;odds_ratio&#39;: inf, &#39;relative_risk&#39;: inf, &#39;lr+&#39;: inf, &#39;lr-&#39;: 0.0}
Rule 1cd50058-f754-4d69-ab42-5690bdccfa1b
{&#39;p&#39;: 48, &#39;n&#39;: 4, &#39;P&#39;: 50, &#39;N&#39;: 100, &#39;p_unique&#39;: 48, &#39;n_unique&#39;: 48, &#39;support&#39;: 52, &#39;conditions_count&#39;: 2, &#39;precision&#39;: 0.9230769230769231, &#39;coverage&#39;: 0.96, &#39;C2&#39;: 0.8669230769230769, &#39;RSS&#39;: 0.9199999999999999, &#39;correlation&#39;: 0.9112931795128765, &#39;lift&#39;: 2.769230769230769, &#39;p_value&#39;: 6.403421751602081e-32, &#39;TP&#39;: 48, &#39;FP&#39;: 4, &#39;TN&#39;: 96, &#39;FN&#39;: 2, &#39;sensitivity&#39;: 0.96, &#39;specificity&#39;: 0.96, &#39;negative_predictive_value&#39;: 0.9795918367346939, &#39;odds_ratio&#39;: 576.0, &#39;relative_risk&#39;: 45.23076923076923, &#39;lr+&#39;: 23.99999999999998, &#39;lr-&#39;: 0.041666666666666706}
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">calculate_ruleset_stats</span></code> function returns some general statistics regarding the rules present in the rule set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">general_stats</span> <span class="o">=</span> <span class="n">ruleset</span><span class="o">.</span><span class="n">calculate_ruleset_stats</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">general_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;rules_count&#39;: 2, &#39;avg_conditions_count&#39;: 1.5, &#39;avg_precision&#39;: 0.96, &#39;avg_coverage&#39;: 0.98, &#39;total_conditions_count&#39;: 3}
</pre></div></div>
</div>
<p>We can serialize the ruleset into a dict using <code class="docutils literal notranslate"><span class="pre">JSONSerializer.serialize</span></code>. The dict can be later stored in a string or in a text file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">decision_rules.serialization</span> <span class="kn">import</span> <span class="n">JSONSerializer</span>

<span class="n">OUTPUT_DIR</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span>
<span class="n">RULESET_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;manual_iris.json&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ruleset_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">RULESET_FILENAME</span><span class="p">)</span>
<span class="c1"># Serialize the ruleset</span>
<span class="n">ruleset_dict</span> <span class="o">=</span> <span class="n">JSONSerializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">ruleset</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">ruleset_dict</span><span class="p">)</span>
<span class="c1"># Save to JSON</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ruleset_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">ruleset_dict</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;meta&#39;: {&#39;attributes&#39;: [&#39;sepallength&#39;,
   &#39;sepalwidth&#39;,
   &#39;petallength&#39;,
   &#39;petalwidth&#39;],
  &#39;decision_attribute&#39;: &#39;class&#39;,
  &#39;decision_attribute_distribution&#39;: {&#39;Iris-setosa&#39;: 50,
   &#39;Iris-versicolor&#39;: 50,
   &#39;Iris-virginica&#39;: 50}},
 &#39;rules&#39;: [{&#39;uuid&#39;: &#39;fd0d78eb-aea8-4ab0-9704-6999d87573c2&#39;,
   &#39;string&#39;: &#39;IF petallength &lt; 2.50 THEN class = Iris-setosa&#39;,
   &#39;premise&#39;: {&#39;type&#39;: &#39;compound&#39;,
    &#39;operator&#39;: &#39;CONJUNCTION&#39;,
    &#39;subconditions&#39;: [{&#39;type&#39;: &#39;elementary_numerical&#39;,
      &#39;attributes&#39;: [2],
      &#39;negated&#39;: False,
      &#39;left&#39;: None,
      &#39;right&#39;: 2.5,
      &#39;left_closed&#39;: False,
      &#39;right_closed&#39;: False}]},
   &#39;conclusion&#39;: {&#39;value&#39;: &#39;Iris-setosa&#39;},
   &#39;coverage&#39;: {&#39;p&#39;: 50, &#39;n&#39;: 0, &#39;P&#39;: 50, &#39;N&#39;: 100}},
  {&#39;uuid&#39;: &#39;1cd50058-f754-4d69-ab42-5690bdccfa1b&#39;,
   &#39;string&#39;: &#39;IF petallength &gt;= 2.50 AND petalwidth &lt; 1.65 THEN class = Iris-versicolor&#39;,
   &#39;premise&#39;: {&#39;type&#39;: &#39;compound&#39;,
    &#39;operator&#39;: &#39;CONJUNCTION&#39;,
    &#39;subconditions&#39;: [{&#39;type&#39;: &#39;elementary_numerical&#39;,
      &#39;attributes&#39;: [2],
      &#39;negated&#39;: False,
      &#39;left&#39;: 2.5,
      &#39;right&#39;: None,
      &#39;left_closed&#39;: True,
      &#39;right_closed&#39;: False},
     {&#39;type&#39;: &#39;elementary_numerical&#39;,
      &#39;attributes&#39;: [3],
      &#39;negated&#39;: False,
      &#39;left&#39;: None,
      &#39;right&#39;: 1.65,
      &#39;left_closed&#39;: False,
      &#39;right_closed&#39;: False}]},
   &#39;conclusion&#39;: {&#39;value&#39;: &#39;Iris-versicolor&#39;},
   &#39;coverage&#39;: {&#39;p&#39;: 48, &#39;n&#39;: 4, &#39;P&#39;: 50, &#39;N&#39;: 100}}]}
</pre></div></div>
</div>
<p>The ruleset can be loaded using <code class="docutils literal notranslate"><span class="pre">JSONSerializer.deserialize</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ruleset_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">reloaded_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
<span class="n">reloaded_ruleset</span> <span class="o">=</span> <span class="n">JSONSerializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">reloaded_json</span><span class="p">,</span> <span class="n">ClassificationRuleSet</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">reloaded_ruleset</span> <span class="o">==</span> <span class="n">ruleset</span>
</pre></div>
</div>
</div>
<p>Before using some of the functions of the deserialized ruleset, it may be necessary to call the <code class="docutils literal notranslate"><span class="pre">update</span></code> function. After that the object will be ready for prediction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reloaded_ruleset</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reloaded_ruleset</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;,
       &#39;Iris-setosa&#39;, &#39;Iris-setosa&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-virginica&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-versicolor&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-versicolor&#39;, &#39;Iris-versicolor&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;,
       &#39;Iris-virginica&#39;, &#39;Iris-virginica&#39;], dtype=&#39;&lt;U15&#39;)
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rules_regression.html" class="btn btn-neutral float-right" title="Evaluate classification rules in decision-rules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Cezary Maszczyk, Dawid Macha, Adam Grzelak.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>